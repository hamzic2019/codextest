"use client";

import {
  createContext,
  useContext,
  useEffect,
  useMemo,
  useState,
  type ReactNode,
} from "react";

export type Language = "bs" | "en" | "de";

const translations = {
  bs: {
    "language.bs": "Bosanski",
    "language.en": "Engleski",
    "language.de": "Njemački",
    "language.bs.helper": "Originalni jezik sa lokalnim terminima.",
    "language.en.helper": "English interface for international teams.",
    "language.de.helper": "Njemački prijevod za DACH timove.",
    "nav.aiPlanner": "AI planner",
    "nav.planOverview": "Pregled plana",
    "nav.patients": "Pacijenti",
    "nav.workers": "Radnici",
    "nav.settings": "Postavke",
    "settings.title": "Postavke",
    "settings.subtitle": "Podešavanje jezika i osnovnih preferencija.",
    "settings.languageLabel": "Jezik aplikacije",
    "settings.languageDescription": "Izaberite jezik interfejsa. Postavka se sprema na ovom uređaju.",
    "settings.selected": "Aktivan",
    "patients.title": "Pacijenti",
    "patients.subtitle": "Brzi pregled i upravljanje",
    "patients.description":
      "Ovdje možete vidjeti listu pacijenata, urediti osnovne podatke ili otvoriti detaljan prikaz kartona.",
    "patients.modal.title": "Dodaj pacijenta",
    "patients.modal.subtitle": "Popuni osnovne informacije i sačuvaj pacijenta prije nastavka.",
    "patients.modal.nameLabel": "Ime i prezime",
    "patients.modal.addressLabel": "Adresa",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Napomene",
    "patients.modal.namePlaceholder": "Ime i prezime",
    "patients.modal.addressPlaceholder": "Ulica, grad, država",
    "patients.modal.levelPlaceholder": "Pflegegrad (npr. 3)",
    "patients.modal.notesPlaceholder": "Specijalni zahtevi, alergije...",
    "patients.modal.save": "Sačuvaj pacijenta",
    "patients.modal.cancel": "Odustani",
    "patients.modal.lastUpdate": "Dodato upravo sada",
    "patients.add": "Dodaj pacijenta",
    "patients.list.title": "Pacijenti",
    "patients.list.subtitle": "Minimalni pregled i brze radnje",
    "patients.list.name": "Ime i prezime",
    "patients.list.actions": "Radnje",
    "patients.list.view": "Pogledaj više",
    "patients.list.edit": "Izmijeni",
    "patients.list.delete": "Izbriši",
    "patients.list.viewAria": "Pogledaj više o {name}",
    "patients.list.editAria": "Izmijeni podatke za {name}",
    "patients.list.deleteAria": "Izbriši pacijenta {name}",
    "workers.title": "Radnici",
    "workers.subtitle": "Brzi pregled i upravljanje",
    "workers.description":
      "Ovdje možete vidjeti listu radnika, urediti osnovne podatke ili otvoriti detaljan prikaz profila.",
    "workers.add": "Dodaj radnika",
    "workers.list.title": "Radnici",
    "workers.list.subtitle": "Minimalni pregled i brze radnje",
    "workers.list.name": "Ime i prezime",
    "workers.list.actions": "Radnje",
    "workers.list.view": "Pogledaj više",
    "workers.list.edit": "Izmijeni",
    "workers.list.delete": "Izbriši",
    "workers.list.viewAria": "Pogledaj više o {name}",
    "workers.list.editAria": "Izmijeni podatke za {name}",
    "workers.list.deleteAria": "Izbriši radnika {name}",
    "workers.modal.title": "Dodaj radnika",
    "workers.modal.subtitle": "Popuni osnovne informacije i dodaj ga u tim.",
    "workers.modal.nameLabel": "Ime i prezime",
    "workers.modal.namePlaceholder": "Ime i prezime",
    "workers.modal.roleLabel": "Uloga",
    "workers.modal.rolePlaceholder": "Pflegefachkraft, Altenpfleger...",
    "workers.modal.cityLabel": "Grad",
    "workers.modal.cityPlaceholder": "Berlin, Hamburg...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.preferredShiftsLabel": "Poželjne smjene",
    "workers.modal.preferredShiftsDay": "Dnevne",
    "workers.modal.preferredShiftsNight": "Noćne",
    "workers.modal.hoursPlannedLabel": "Planirani sati",
    "workers.modal.hoursCompletedLabel": "Odrađeni sati",
    "workers.modal.save": "Sačuvaj radnika",
    "workers.modal.cancel": "Odustani",
    "common.backTo": "Nazad na {target}",
    "patientDetail.label": "Pacijent",
    "patientDetail.activeShifts": "Aktuelne smjene",
    "patientDetail.shiftsSubtitle": "Dummy podaci — kasnije dolazi fetch iz Supabase",
    "patientDetail.noShifts": "Nema smjena još definisanih.",
    "patientDetail.shift.day": "Dnevna",
    "patientDetail.shift.night": "Noćna",
    "patientDetail.planTitle": "AI plan - pregled",
    "patientDetail.planSubtitle": "Pokaži kako izgleda prijedlog prije snimanja",
    "patientDetail.planMissing": "Plan nije generisan",
    "patientDetail.planHint": "Dodaj prompt u planneru da vidiš generisani raspored.",
    "patientDetail.openPlanner": "Otvori AI planner",
    "workerDetail.label": "Radnik",
    "workerDetail.planned": "Planirano {hours}h",
    "workerDetail.completed": "Odradio {hours}h",
    "workerDetail.shift.day": "Dnevne",
    "workerDetail.shift.night": "Noćne",
    "workerDetail.activeShifts": "Aktuelne smjene",
    "workerDetail.shiftsSubtitle": "Dummy pregled — kasnije povezati sa Supabase",
    "workerDetail.noShifts": "Nema zakazanih smjena.",
    "planner.title": "AI planner",
    "planner.workersLabel": "Radnici",
    "planner.patient.label": "Pacijent",
    "planner.patient.placeholder": "Odaberi pacijenta",
    "planner.worker.searchTitle": "Radnici",
    "planner.worker.searchSelected": "{count} odabrano · klikni da dodaš još",
    "planner.worker.searchPlaceholder": "Pretraži ili scrollaj listu",
    "planner.worker.searchInputPlaceholder": "Ime, grad ili pozicija",
    "planner.worker.searchEmpty": "Nema rezultata",
    "planner.worker.searchBadge": "Live search",
    "planner.worker.status.radnik": "Radnik",
    "planner.worker.status.pocetnik": "Početnik",
    "planner.worker.status.anerkennung": "Anerkennung",
    "planner.worker.removeAria": "Ukloni radnika",
    "planner.worker.priority": "Prioritet",
    "planner.worker.addPriority": "Dodaj prioritet",
    "planner.worker.shiftFocus": "Fokus smjene",
    "planner.worker.planDays": "Planiraj dana",
    "planner.worker.balance": "Balans D / N",
    "planner.worker.focusBalanced": "Balansirano",
    "planner.worker.focusDay": "Dnevne {percent}%",
    "planner.worker.focusNight": "Noćne {percent}%",
    "planner.worker.allowDay": "Dnevne",
    "planner.worker.allowNight": "Noćne",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Sažet opis: rotiraj noćne na 2-3 dana, Maja dnevne, bez preklopa...",
    "planner.generate": "Generiši prijedlog",
    "planner.generate.monthLabel": "Mjesec",
    "planner.generate.yearLabel": "Godina",
    "planner.save": "Spasi plan",
    "planner.preview.kicker": "Pregled plana",
    "planner.preview.title": "Pregled rotacije radnika",
    "planner.preview.meta": "{days} dana · {workers} radnika",
    "planner.preview.date": "Datum",
    "planner.preview.day": "Dnevna",
    "planner.preview.night": "Noćna",
    "planner.shift.dayLabel": "Dnevna smjena",
    "planner.shift.nightLabel": "Noćna smjena",
    "planner.shift.unknown": "Nepoznat",
    "planner.noAvailableWorkers": "Nema dostupnih radnika",
    "overview.title": "Pregled plana",
    "overview.subtitle": "Brzi pregled rotacije po pacijentu",
    "overview.unassigned": "Nije dodijeljeno",
    "overview.calendar.monthLabel": "Mjesec",
    "overview.calendar.yearLabel": "Godina",
    "overview.calendar.monthSelectAria": "Izaberi mjesec",
    "overview.calendar.yearSelectAria": "Izaberi godinu",
    "overview.calendar.todayLabel": "Danas",
    "overview.summary.title": "Sažetak plana",
    "overview.summary.subtitle": "Glavne smjernice i napomene",
    "overview.summary.highlights": "Napomene",
    "overview.summary.empty": "Nema spremljenog sažetka za ovog pacijenta.",
  },
  en: {
    "language.bs": "Bosnian",
    "language.en": "English",
    "language.de": "German",
    "language.bs.helper": "Original language with local terms.",
    "language.en.helper": "English interface for international teams.",
    "language.de.helper": "German copy for DACH teams.",
    "nav.aiPlanner": "AI Planner",
    "nav.planOverview": "Plan overview",
    "nav.patients": "Patients",
    "nav.workers": "Workers",
    "nav.settings": "Settings",
    "settings.title": "Settings",
    "settings.subtitle": "Configure language and basic preferences.",
    "settings.languageLabel": "App language",
    "settings.languageDescription": "Choose which language to use. This preference is stored on this device.",
    "settings.selected": "Selected",
    "patients.title": "Patients",
    "patients.subtitle": "Quick overview & management",
    "patients.description":
      "See your patient list, edit basic info or open the detailed chart.",
    "patients.modal.title": "Add patient",
    "patients.modal.subtitle": "Capture the baseline data before continuing with scheduling.",
    "patients.modal.nameLabel": "Full name",
    "patients.modal.addressLabel": "Address",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Notes",
    "patients.modal.namePlaceholder": "First + last name",
    "patients.modal.addressPlaceholder": "Street, city, country",
    "patients.modal.levelPlaceholder": "Pflegegrad (e.g. 3)",
    "patients.modal.notesPlaceholder": "Special requirements, allergies...",
    "patients.modal.save": "Save patient",
    "patients.modal.cancel": "Cancel",
    "patients.modal.lastUpdate": "Added just now",
    "patients.add": "Add patient",
    "patients.list.title": "Patients",
    "patients.list.subtitle": "Minimal view and quick actions",
    "patients.list.name": "Full name",
    "patients.list.actions": "Actions",
    "patients.list.view": "View",
    "patients.list.edit": "Edit",
    "patients.list.delete": "Delete",
    "patients.list.viewAria": "View details for {name}",
    "patients.list.editAria": "Edit details for {name}",
    "patients.list.deleteAria": "Delete patient {name}",
    "workers.title": "Workers",
    "workers.subtitle": "Quick overview & management",
    "workers.description":
      "See your staff list, edit basic info or open the detailed profile.",
    "workers.add": "Add worker",
    "workers.list.title": "Workers",
    "workers.list.subtitle": "Minimal view and quick actions",
    "workers.list.name": "Full name",
    "workers.list.actions": "Actions",
    "workers.list.view": "View",
    "workers.list.edit": "Edit",
    "workers.list.delete": "Delete",
    "workers.list.viewAria": "View details for {name}",
    "workers.list.editAria": "Edit details for {name}",
    "workers.list.deleteAria": "Delete worker {name}",
    "workers.modal.title": "Add worker",
    "workers.modal.subtitle": "Capture the profile details before assigning shifts.",
    "workers.modal.nameLabel": "Full name",
    "workers.modal.namePlaceholder": "First + last name",
    "workers.modal.roleLabel": "Role",
    "workers.modal.rolePlaceholder": "e.g. Altenpfleger, Springer",
    "workers.modal.cityLabel": "City",
    "workers.modal.cityPlaceholder": "Berlin, Munich...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.preferredShiftsLabel": "Preferred shifts",
    "workers.modal.preferredShiftsDay": "Day",
    "workers.modal.preferredShiftsNight": "Night",
    "workers.modal.hoursPlannedLabel": "Planned hours",
    "workers.modal.hoursCompletedLabel": "Completed hours",
    "workers.modal.save": "Save worker",
    "workers.modal.cancel": "Cancel",
    "common.backTo": "Back to {target}",
    "patientDetail.label": "Patient",
    "patientDetail.activeShifts": "Current shifts",
    "patientDetail.shiftsSubtitle": "Dummy data — will fetch from Supabase later",
    "patientDetail.noShifts": "No shifts defined yet.",
    "patientDetail.shift.day": "Day",
    "patientDetail.shift.night": "Night",
    "patientDetail.planTitle": "AI plan - preview",
    "patientDetail.planSubtitle": "See the proposal before saving",
    "patientDetail.planMissing": "Plan not generated",
    "patientDetail.planHint": "Add a prompt in the planner to see the schedule.",
    "patientDetail.openPlanner": "Open AI planner",
    "workerDetail.label": "Worker",
    "workerDetail.planned": "Planned {hours}h",
    "workerDetail.completed": "Completed {hours}h",
    "workerDetail.shift.day": "Day shifts",
    "workerDetail.shift.night": "Night shifts",
    "workerDetail.activeShifts": "Current shifts",
    "workerDetail.shiftsSubtitle": "Dummy overview — wire to Supabase later",
    "workerDetail.noShifts": "No shifts scheduled.",
    "planner.title": "AI planner",
    "planner.workersLabel": "Workers",
    "planner.patient.label": "Patient",
    "planner.patient.placeholder": "Select a patient",
    "planner.worker.searchTitle": "Workers",
    "planner.worker.searchSelected": "{count} selected · click to add more",
    "planner.worker.searchPlaceholder": "Search or scroll the list",
    "planner.worker.searchInputPlaceholder": "Name, city or role",
    "planner.worker.searchEmpty": "No results",
    "planner.worker.searchBadge": "Live search",
    "planner.worker.status.radnik": "Staff",
    "planner.worker.status.pocetnik": "Trainee",
    "planner.worker.status.anerkennung": "Recognition",
    "planner.worker.removeAria": "Remove worker",
    "planner.worker.priority": "Priority",
    "planner.worker.addPriority": "Mark as priority",
    "planner.worker.shiftFocus": "Shift focus",
    "planner.worker.planDays": "Plan days",
    "planner.worker.balance": "Balance D / N",
    "planner.worker.focusBalanced": "Balanced",
    "planner.worker.focusDay": "Day {percent}%",
    "planner.worker.focusNight": "Night {percent}%",
    "planner.worker.allowDay": "Day",
    "planner.worker.allowNight": "Night",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Short prompt: rotate nights every 2-3 days, Maja day shifts, avoid overlaps...",
    "planner.generate": "Generate proposal",
    "planner.generate.monthLabel": "Month",
    "planner.generate.yearLabel": "Year",
    "planner.save": "Save plan",
    "planner.preview.kicker": "Plan overview",
    "planner.preview.title": "Worker rotation preview",
    "planner.preview.meta": "{days} days · {workers} workers",
    "planner.preview.date": "Date",
    "planner.preview.day": "Day",
    "planner.preview.night": "Night",
    "planner.shift.dayLabel": "Day shift",
    "planner.shift.nightLabel": "Night shift",
    "planner.shift.unknown": "Unknown",
    "planner.noAvailableWorkers": "No available workers",
    "overview.title": "Plan overview",
    "overview.subtitle": "Quick rotation overview per patient",
    "overview.unassigned": "Unassigned",
    "overview.calendar.monthLabel": "Month",
    "overview.calendar.yearLabel": "Year",
    "overview.calendar.monthSelectAria": "Select month",
    "overview.calendar.yearSelectAria": "Select year",
    "overview.calendar.todayLabel": "Today",
    "overview.summary.title": "Plan summary",
    "overview.summary.subtitle": "Key guidance and notes",
    "overview.summary.highlights": "Highlights",
    "overview.summary.empty": "No saved summary for this patient yet.",
  },
  de: {
    "language.bs": "Bosnisch",
    "language.en": "Englisch",
    "language.de": "Deutsch",
    "language.bs.helper": "Originalsprache mit lokalen Begriffen.",
    "language.en.helper": "Englische Oberfläche für internationale Teams.",
    "language.de.helper": "Deutsche Oberfläche für DACH Teams.",
    "nav.aiPlanner": "KI-Planer",
    "nav.planOverview": "Plan-Übersicht",
    "nav.patients": "Patienten",
    "nav.workers": "Mitarbeiter",
    "nav.settings": "Einstellungen",
    "settings.title": "Einstellungen",
    "settings.subtitle": "Sprache und Basiseinstellungen anpassen.",
    "settings.languageLabel": "App-Sprache",
    "settings.languageDescription": "Wähle die Sprache der Oberfläche. Einstellung wird lokal gespeichert.",
    "settings.selected": "Aktiv",
    "patients.title": "Patienten",
    "patients.subtitle": "Schneller Überblick & Verwaltung",
    "patients.description":
      "Sieh die Patientenliste, bearbeite Stammdaten oder öffne die Detailansicht.",
    "patients.modal.title": "Patient hinzufügen",
    "patients.modal.subtitle": "Schnell Basisdaten erfassen, bevor du planst.",
    "patients.modal.nameLabel": "Name",
    "patients.modal.addressLabel": "Adresse",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Notizen",
    "patients.modal.namePlaceholder": "Vor- und Nachname",
    "patients.modal.addressPlaceholder": "Straße, Stadt, Land",
    "patients.modal.levelPlaceholder": "Pflegegrad (z. B. 3)",
    "patients.modal.notesPlaceholder": "Besondere Hinweise, Allergien...",
    "patients.modal.save": "Patient speichern",
    "patients.modal.cancel": "Abbrechen",
    "patients.modal.lastUpdate": "Gerade erst angelegt",
    "patients.add": "Patient hinzufügen",
    "patients.list.title": "Patienten",
    "patients.list.subtitle": "Kompaktansicht mit Schnellaktionen",
    "patients.list.name": "Name",
    "patients.list.actions": "Aktionen",
    "patients.list.view": "Ansehen",
    "patients.list.edit": "Bearbeiten",
    "patients.list.delete": "Löschen",
    "patients.list.viewAria": "Details zu {name} ansehen",
    "patients.list.editAria": "Daten für {name} bearbeiten",
    "patients.list.deleteAria": "Patient {name} löschen",
    "workers.title": "Mitarbeiter",
    "workers.subtitle": "Schneller Überblick & Verwaltung",
    "workers.description":
      "Mitarbeiterliste einsehen, Stammdaten bearbeiten oder Profil öffnen.",
    "workers.add": "Mitarbeiter hinzufügen",
    "workers.list.title": "Mitarbeiter",
    "workers.list.subtitle": "Kompaktansicht mit Schnellaktionen",
    "workers.list.name": "Name",
    "workers.list.actions": "Aktionen",
    "workers.list.view": "Ansehen",
    "workers.list.edit": "Bearbeiten",
    "workers.list.delete": "Löschen",
    "workers.list.viewAria": "Details zu {name} ansehen",
    "workers.list.editAria": "Daten für {name} bearbeiten",
    "workers.list.deleteAria": "Mitarbeiter {name} löschen",
    "workers.modal.title": "Mitarbeiter hinzufügen",
    "workers.modal.subtitle": "Gib die wichtigsten Daten ein, bevor du ihn planst.",
    "workers.modal.nameLabel": "Name",
    "workers.modal.namePlaceholder": "Vor- und Nachname",
    "workers.modal.roleLabel": "Rolle",
    "workers.modal.rolePlaceholder": "z. B. Altenpfleger, Springer",
    "workers.modal.cityLabel": "Stadt",
    "workers.modal.cityPlaceholder": "Berlin, München...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.preferredShiftsLabel": "Bevorzugte Dienste",
    "workers.modal.preferredShiftsDay": "Tag",
    "workers.modal.preferredShiftsNight": "Nacht",
    "workers.modal.hoursPlannedLabel": "Geplante Stunden",
    "workers.modal.hoursCompletedLabel": "Geleistete Stunden",
    "workers.modal.save": "Mitarbeiter speichern",
    "workers.modal.cancel": "Abbrechen",
    "common.backTo": "Zurück zu {target}",
    "patientDetail.label": "Patient",
    "patientDetail.activeShifts": "Aktuelle Dienste",
    "patientDetail.shiftsSubtitle": "Dummy-Daten — später Supabase-Anbindung",
    "patientDetail.noShifts": "Noch keine Dienste hinterlegt.",
    "patientDetail.shift.day": "Tagdienst",
    "patientDetail.shift.night": "Nachtdienst",
    "patientDetail.planTitle": "KI-Plan - Vorschau",
    "patientDetail.planSubtitle": "Vorschlag ansehen bevor er gespeichert wird",
    "patientDetail.planMissing": "Plan nicht generiert",
    "patientDetail.planHint": "Füge im Planer einen Prompt hinzu, um den Plan zu sehen.",
    "patientDetail.openPlanner": "KI-Planer öffnen",
    "workerDetail.label": "Mitarbeiter",
    "workerDetail.planned": "Geplant {hours}h",
    "workerDetail.completed": "Geleistet {hours}h",
    "workerDetail.shift.day": "Tagdienste",
    "workerDetail.shift.night": "Nachtdienste",
    "workerDetail.activeShifts": "Aktuelle Dienste",
    "workerDetail.shiftsSubtitle": "Dummy-Übersicht — später Supabase-Anbindung",
    "workerDetail.noShifts": "Keine Dienste geplant.",
    "planner.title": "KI-Planer",
    "planner.workersLabel": "Mitarbeiter",
    "planner.patient.label": "Patient",
    "planner.patient.placeholder": "Patient auswählen",
    "planner.worker.searchTitle": "Mitarbeiter",
    "planner.worker.searchSelected": "{count} ausgewählt · klicke um mehr hinzuzufügen",
    "planner.worker.searchPlaceholder": "Liste durchsuchen oder scrollen",
    "planner.worker.searchInputPlaceholder": "Name, Stadt oder Rolle",
    "planner.worker.searchEmpty": "Keine Ergebnisse",
    "planner.worker.searchBadge": "Live-Suche",
    "planner.worker.status.radnik": "Fachkraft",
    "planner.worker.status.pocetnik": "Einsteiger",
    "planner.worker.status.anerkennung": "Anerkennung",
    "planner.worker.removeAria": "Mitarbeiter entfernen",
    "planner.worker.priority": "Priorität",
    "planner.worker.addPriority": "Als Priorität markieren",
    "planner.worker.shiftFocus": "Schicht-Fokus",
    "planner.worker.planDays": "Geplante Tage",
    "planner.worker.balance": "Balance T / N",
    "planner.worker.focusBalanced": "Ausgewogen",
    "planner.worker.focusDay": "Tag {percent}%",
    "planner.worker.focusNight": "Nacht {percent}%",
    "planner.worker.allowDay": "Tag",
    "planner.worker.allowNight": "Nacht",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Kurzbeschreibung: Nachtdienste alle 2-3 Tage rotieren, Maja Tagdienste, keine Überschneidungen...",
    "planner.generate": "Vorschlag generieren",
    "planner.generate.monthLabel": "Monat",
    "planner.generate.yearLabel": "Jahr",
    "planner.save": "Plan speichern",
    "planner.preview.kicker": "Plan-Übersicht",
    "planner.preview.title": "Vorschau der Mitarbeitereinteilung",
    "planner.preview.meta": "{days} Tage · {workers} Mitarbeiter",
    "planner.preview.date": "Datum",
    "planner.preview.day": "Tag",
    "planner.preview.night": "Nacht",
    "planner.shift.dayLabel": "Tagdienst",
    "planner.shift.nightLabel": "Nachtdienst",
    "planner.shift.unknown": "Unbekannt",
    "planner.noAvailableWorkers": "Keine verfügbaren Mitarbeiter",
    "overview.title": "Plan-Übersicht",
    "overview.subtitle": "Schneller Rotationsüberblick pro Patient",
    "overview.unassigned": "Nicht zugewiesen",
    "overview.calendar.monthLabel": "Monat",
    "overview.calendar.yearLabel": "Jahr",
    "overview.calendar.monthSelectAria": "Monat wählen",
    "overview.calendar.yearSelectAria": "Jahr wählen",
    "overview.calendar.todayLabel": "Heute",
    "overview.summary.title": "Plan-Zusammenfassung",
    "overview.summary.subtitle": "Wichtige Hinweise und Notizen",
    "overview.summary.highlights": "Highlights",
    "overview.summary.empty": "Noch keine gespeicherte Zusammenfassung für diesen Patienten.",
  },
} satisfies Record<Language, Record<string, string>>;

type TranslationKey = keyof typeof translations.bs;

type TranslationContextValue = {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: TranslationKey, vars?: Record<string, string | number>) => string;
};

const LanguageContext = createContext<TranslationContextValue | undefined>(
  undefined
);

function isLanguage(value: string | null): value is Language {
  return value === "bs" || value === "en" || value === "de";
}

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [language, setLanguage] = useState<Language>(() => {
    if (typeof window === "undefined") return "bs";
    const stored = window.localStorage.getItem("pflege-language");
    return isLanguage(stored) ? stored : "bs";
  });

  useEffect(() => {
    if (typeof window === "undefined") return;
    window.localStorage.setItem("pflege-language", language);
    document.documentElement.lang = language;
  }, [language]);

  const translate = useMemo(() => {
    return (key: TranslationKey, vars?: Record<string, string | number>) => {
      const template =
        translations[language]?.[key] ?? translations.bs[key] ?? key;

      if (!vars) return template;
      return Object.keys(vars).reduce(
        (acc, varKey) =>
          acc.replace(new RegExp(`{${varKey}}`, "g"), String(vars[varKey])),
        template
      );
    };
  }, [language]);

  const value = useMemo(
    () => ({
      language,
      setLanguage,
      t: translate,
    }),
    [language, translate]
  );

  return (
    <LanguageContext.Provider value={value}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useTranslations() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useTranslations must be used within LanguageProvider");
  }
  return context;
}

export const LANGUAGE_OPTIONS: {
  code: Language;
  accent: string;
  short: string;
}[] = [
  { code: "bs", accent: "from-sky-500 via-sky-400 to-amber-400", short: "BS" },
  { code: "de", accent: "from-amber-500 via-orange-400 to-red-500", short: "DE" },
  { code: "en", accent: "from-indigo-500 via-blue-500 to-sky-500", short: "EN" },
];
