"use client";

import {
  createContext,
  useContext,
  useEffect,
  useMemo,
  useState,
  type ReactNode,
} from "react";

export type Language = "bs" | "en" | "de";

const translations = {
  bs: {
    "language.bs": "Bosanski",
    "language.en": "Engleski",
    "language.de": "Njemački",
    "language.bs.helper": "Originalni jezik sa lokalnim terminima.",
    "language.en.helper": "English interface for international teams.",
    "language.de.helper": "Njemački prijevod za DACH timove.",
    "nav.aiPlanner": "AI planner",
    "nav.planOverview": "Pregled plana",
    "nav.analytics": "Analitika",
    "nav.patients": "Pacijenti",
    "nav.workers": "Radnici",
    "nav.settings": "Postavke",
    "settings.title": "Postavke",
    "settings.subtitle": "Podešavanje jezika i osnovnih preferencija.",
    "settings.languageLabel": "Jezik aplikacije",
    "settings.languageDescription": "Izaberite jezik interfejsa. Postavka se sprema na ovom uređaju.",
    "settings.selected": "Aktivan",
    "patients.title": "Pacijenti",
    "patients.subtitle": "Brzi pregled i upravljanje",
    "patients.description":
      "Ovdje možete vidjeti listu pacijenata, urediti osnovne podatke ili otvoriti detaljan prikaz kartona.",
    "patients.modal.title": "Dodaj pacijenta",
    "patients.modal.viewTitle": "Pregled pacijenta",
    "patients.modal.editTitle": "Uredi pacijenta",
    "patients.modal.subtitle": "Popuni osnovne informacije i sačuvaj pacijenta prije nastavka.",
    "patients.modal.viewSubtitle": "Brzi pregled podataka koje možeš odmah urediti.",
    "patients.modal.editSubtitle": "Ažuriraj osnovne podatke i snimi promjene.",
    "patients.modal.nameLabel": "Ime i prezime",
    "patients.modal.cityLabel": "Grad",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Napomene",
    "patients.modal.namePlaceholder": "Ime i prezime",
    "patients.modal.cityPlaceholder": "Berlin, Hamburg...",
    "patients.modal.levelPlaceholder": "Pflegegrad (npr. 3)",
    "patients.modal.notesPlaceholder": "Specijalni zahtevi, alergije...",
    "patients.modal.save": "Sačuvaj pacijenta",
    "patients.modal.update": "Spremi izmjene",
    "patients.modal.saving": "Spremam...",
    "patients.modal.deleting": "Brišem...",
    "patients.modal.confirmDelete": "Potvrdi brisanje",
    "patients.modal.deleteHint": "Klikni još jednom da potvrdiš brisanje pacijenta.",
    "patients.modal.cancel": "Odustani",
    "patients.modal.lastUpdate": "Dodato upravo sada",
    "patients.add": "Dodaj pacijenta",
    "patients.list.title": "Pacijenti",
    "patients.list.subtitle": "Minimalni pregled i brze radnje",
    "patients.list.name": "Ime i prezime",
    "patients.list.actions": "Radnje",
    "patients.list.view": "Pogledaj više",
    "patients.list.edit": "Izmijeni",
    "patients.list.delete": "Izbriši",
    "patients.list.viewAria": "Pogledaj više o {name}",
    "patients.list.editAria": "Izmijeni podatke za {name}",
    "patients.list.deleteAria": "Izbriši pacijenta {name}",
    "patients.list.loading": "Učitavam pacijente...",
    "patients.list.empty": "Još nema spremljenih pacijenata.",
    "patients.error": "Greška pri učitavanju pacijenata.",
    "patients.saveError": "Greška pri snimanju pacijenta.",
    "patients.deleteError": "Greška pri brisanju pacijenta.",
    "workers.title": "Radnici",
    "workers.subtitle": "Brzi pregled i upravljanje",
    "workers.description":
      "Ovdje možete vidjeti listu radnika, urediti osnovne podatke ili otvoriti detaljan prikaz profila.",
    "workers.add": "Dodaj radnika",
    "workers.list.title": "Radnici",
    "workers.list.subtitle": "Minimalni pregled i brze radnje",
    "workers.list.name": "Ime i prezime",
    "workers.list.actions": "Radnje",
    "workers.list.view": "Pogledaj više",
    "workers.list.edit": "Izmijeni",
    "workers.list.delete": "Izbriši",
    "workers.list.viewAria": "Pogledaj više o {name}",
    "workers.list.editAria": "Izmijeni podatke za {name}",
    "workers.list.deleteAria": "Izbriši radnika {name}",
    "workers.list.loading": "Učitavam radnike...",
    "workers.list.empty": "Još nema radnika.",
    "workers.error": "Greška pri učitavanju radnika.",
    "workers.saveError": "Greška pri snimanju radnika.",
    "workers.deleteError": "Greška pri brisanju radnika.",
    "workers.modal.title": "Dodaj radnika",
    "workers.modal.viewTitle": "Profil radnika",
    "workers.modal.editTitle": "Uredi radnika",
    "workers.modal.subtitle": "Popuni osnovne informacije i dodaj ga u tim.",
    "workers.modal.viewSubtitle": "Brzi pregled podataka; izmijeni po potrebi.",
    "workers.modal.editSubtitle": "Ažuriraj status ili planirane sate i snimi.",
    "workers.modal.nameLabel": "Ime i prezime",
    "workers.modal.namePlaceholder": "Ime i prezime",
    "workers.modal.cityLabel": "Grad",
    "workers.modal.cityPlaceholder": "Berlin, Hamburg...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.hoursPlannedLabel": "Planirani sati",
    "workers.modal.hoursPlannedHelper": "Planirani broj sati za mjesec.",
    "workers.modal.save": "Sačuvaj radnika",
    "workers.modal.update": "Spremi izmjene",
    "workers.modal.saving": "Spremam...",
    "workers.modal.deleting": "Brišem...",
    "workers.modal.confirmDelete": "Potvrdi brisanje",
    "workers.modal.deleteHint": "Klikni još jednom da obrišeš radnika.",
    "workers.modal.cancel": "Odustani",
    "common.backTo": "Nazad na {target}",
    "patientDetail.label": "Pacijent",
    "patientDetail.activeShifts": "Aktuelne smjene",
    "patientDetail.shiftsSubtitle": "Dummy podaci — kasnije dolazi fetch iz Supabase",
    "patientDetail.noShifts": "Nema smjena još definisanih.",
    "patientDetail.shift.day": "Dnevna",
    "patientDetail.shift.night": "Noćna",
    "patientDetail.planTitle": "AI plan - pregled",
    "patientDetail.planSubtitle": "Pokaži kako izgleda prijedlog prije snimanja",
    "patientDetail.planMissing": "Plan nije generisan",
    "patientDetail.planHint": "Dodaj prompt u planneru da vidiš generisani raspored.",
    "patientDetail.openPlanner": "Otvori AI planner",
    "workerDetail.label": "Radnik",
    "workerDetail.planned": "Planirano {hours}h",
    "workerDetail.completed": "Odradio {hours}h",
    "workerDetail.shift.day": "Dnevne",
    "workerDetail.shift.night": "Noćne",
    "workerDetail.activeShifts": "Aktuelne smjene",
    "workerDetail.shiftsSubtitle": "Dummy pregled — kasnije povezati sa Supabase",
    "workerDetail.noShifts": "Nema zakazanih smjena.",
    "planner.title": "AI planner",
    "planner.workersLabel": "Radnici",
    "planner.patient.label": "Pacijent",
    "planner.patient.placeholder": "Odaberi pacijenta",
    "planner.patient.loading": "Učitavam pacijente...",
    "planner.patient.empty": "Nema pacijenata u bazi.",
    "planner.worker.searchTitle": "Radnici",
    "planner.worker.searchSelected": "{count} odabrano · klikni da dodaš još",
    "planner.worker.searchPlaceholder": "Pretraži ili scrollaj listu",
    "planner.worker.searchInputPlaceholder": "Ime, grad ili pozicija",
    "planner.worker.searchEmpty": "Nema rezultata",
    "planner.worker.searchBadge": "Live search",
    "planner.worker.status.radnik": "Radnik",
    "planner.worker.status.anarbeitung": "Anarbeitung",
    "planner.worker.status.student": "Student",
    "planner.worker.status.externi": "Eksterni radnik",
    "planner.worker.status.pocetnik": "Početnik",
    "planner.worker.status.anerkennung": "Anerkennung",
    "planner.worker.roleFallback": "Bez titule",
    "planner.worker.removeAria": "Ukloni radnika",
    "planner.worker.priority": "Prioritet",
    "planner.worker.addPriority": "Dodaj prioritet",
    "planner.worker.shiftFocus": "Fokus smjene",
    "planner.worker.planDays": "Planiraj smjene do",
    "planner.worker.balance": "Balans D / N",
    "planner.worker.focusBalanced": "Balansirano",
    "planner.worker.focusDay": "Dnevne {percent}%",
    "planner.worker.focusNight": "Noćne {percent}%",
    "planner.worker.allowDay": "Dnevne",
    "planner.worker.allowNight": "Noćne",
    "planner.lockShift": "Zaključaj smjenu",
    "planner.unlockShift": "Otključaj smjenu",
    "planner.lockedLabel": "Zaključano",
    "planner.unsavedChanges": "Promjene nisu sačuvane — klikni Spasi plan",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Sažet opis: rotiraj noćne na 2-3 dana, Maja dnevne, bez preklopa...",
    "planner.generate": "Generiši prijedlog",
    "planner.export": "Exportuj plan",
    "planner.generate.monthLabel": "Mjesec",
    "planner.generate.yearLabel": "Godina",
    "planner.save": "Spasi plan",
    "planner.preview.kicker": "Pregled plana",
    "planner.preview.title": "Pregled rotacije radnika",
    "planner.preview.meta": "{days} dana",
    "planner.preview.date": "Datum",
    "planner.preview.day": "Dnevna",
    "planner.preview.night": "Noćna",
    "planner.shift.dayLabel": "Dnevna smjena",
    "planner.shift.nightLabel": "Noćna smjena",
    "planner.shift.unknown": "Nepoznat",
    "planner.noAvailableWorkers": "Nema dostupnih radnika",
    "planner.loadError": "Greška pri učitavanju podataka.",
    "planner.loading": "Učitavam podatke...",
    "planner.noWorkers": "Nema radnika u bazi — dodaj ih na stranici Radnici.",
    "planner.generateMissing": "Odaberi pacijenta i barem jednog radnika.",
    "planner.generateSuccess": "AI prijedlog je spreman.",
    "planner.generateError": "Generisanje plana nije uspjelo.",
    "planner.saveSuccess": "Plan je spašen u Supabase.",
    "planner.saveError": "Greška pri snimanju plana.",
    "planner.generating": "Generišem...",
    "planner.saving": "Spremam...",
    "planner.preview.assigned": "{count} smjena dodijeljeno",
    "planner.daysClamped": "Broj dana je skraćen na max {max} dana.",
    "overview.title": "Pregled plana",
    "overview.subtitle": "Brzi pregled rotacije po pacijentu",
    "overview.unassigned": "Nije dodijeljeno",
    "overview.calendar.monthLabel": "Mjesec",
    "overview.calendar.yearLabel": "Godina",
    "overview.calendar.monthSelectAria": "Izaberi mjesec",
    "overview.calendar.yearSelectAria": "Izaberi godinu",
    "overview.calendar.todayLabel": "Danas",
    "overview.summary.title": "Sažetak plana",
    "overview.summary.subtitle": "Glavne smjernice i napomene",
    "overview.summary.highlights": "Napomene",
    "overview.summary.empty": "Nema spremljenog sažetka za ovog pacijenta.",
    "overview.loadError": "Greška pri učitavanju plana.",
    "overview.loading": "Učitavam plan...",
    "overview.noPlan": "Nema spremljenog plana za ovaj mjesec.",
    "overview.delete": "Obriši plan",
    "overview.deleteConfirm": "Potvrdi brisanje",
    "overview.deleteHint": "Klikni još jednom da obrišeš plan za ovaj mjesec.",
    "overview.deleteDialog.title": "Obriši plan?",
    "overview.deleteDialog.body":
      "Da li si siguran da želiš obrisati ovaj plan? Nakon brisanja, svi podaci će biti trajno uklonjeni.",
    "overview.deleting": "Brišem...",
    "overview.deleteSuccess": "Plan je obrisan.",
    "overview.deleteError": "Greška pri brisanju plana.",
    "analytics.title": "Analitika",
    "analytics.subtitle": "Pregled planiranih smjena po radniku",
    "analytics.filters.helper": "Biraj radnik + mjesec + godina",
    "analytics.filters.worker": "Radnik",
    "analytics.filters.month": "Mjesec",
    "analytics.filters.year": "Godina",
    "analytics.loading": "Učitavam podatke...",
    "analytics.error": "Greška pri učitavanju analitike.",
    "analytics.empty": "Nema planiranih smjena za ovaj period.",
    "analytics.cards.totalShifts": "Ukupno smjena",
    "analytics.cards.dayShifts": "Dnevne smjene",
    "analytics.cards.nightShifts": "Noćne smjene",
    "analytics.cards.totalHours": "Ukupno sati",
    "analytics.cards.dayHours": "Dnevni sati",
    "analytics.cards.nightHours": "Noćni sati",
    "analytics.cards.avgHours": "Prosječno po smjeni",
    "analytics.cards.periodLabel": "{month} {year}.",
    "analytics.cards.activeWeeks": "Aktivnih sedmica",
    "analytics.chart.title": "Sedmični raspored",
    "analytics.chart.subtitle": "Udio dnevnih/noćnih po sedmici",
    "analytics.chart.weekLabel": "Sedmica {week}",
    "analytics.patients.title": "Pacijenti",
    "analytics.patients.subtitle": "Na koga je raspoređen",
    "analytics.patients.none": "Nema povezanih pacijenata za ovaj period.",
    "analytics.timeline.title": "Planirane smjene",
    "analytics.timeline.subtitle": "Datum, smjena i pacijent",
    "analytics.timeline.day": "Dnevna smjena",
    "analytics.timeline.night": "Noćna smjena",
    "analytics.timeline.unassignedPatient": "Bez pacijenta",
  },
  en: {
    "language.bs": "Bosnian",
    "language.en": "English",
    "language.de": "German",
    "language.bs.helper": "Original language with local terms.",
    "language.en.helper": "English interface for international teams.",
    "language.de.helper": "German copy for DACH teams.",
    "nav.aiPlanner": "AI Planner",
    "nav.planOverview": "Plan overview",
    "nav.analytics": "Analytics",
    "nav.patients": "Patients",
    "nav.workers": "Workers",
    "nav.settings": "Settings",
    "settings.title": "Settings",
    "settings.subtitle": "Configure language and basic preferences.",
    "settings.languageLabel": "App language",
    "settings.languageDescription": "Choose which language to use. This preference is stored on this device.",
    "settings.selected": "Selected",
    "patients.title": "Patients",
    "patients.subtitle": "Quick overview & management",
    "patients.description":
      "See your patient list, edit basic info or open the detailed chart.",
    "patients.modal.title": "Add patient",
    "patients.modal.viewTitle": "Patient profile",
    "patients.modal.editTitle": "Edit patient",
    "patients.modal.subtitle": "Capture the baseline data before continuing with scheduling.",
    "patients.modal.viewSubtitle": "Quick readout of stored data with inline edit.",
    "patients.modal.editSubtitle": "Update core info and save the changes.",
    "patients.modal.nameLabel": "Full name",
    "patients.modal.cityLabel": "City",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Notes",
    "patients.modal.namePlaceholder": "First + last name",
    "patients.modal.cityPlaceholder": "Berlin, Hamburg...",
    "patients.modal.levelPlaceholder": "Pflegegrad (e.g. 3)",
    "patients.modal.notesPlaceholder": "Special requirements, allergies...",
    "patients.modal.save": "Save patient",
    "patients.modal.update": "Save changes",
    "patients.modal.saving": "Saving...",
    "patients.modal.deleting": "Deleting...",
    "patients.modal.confirmDelete": "Confirm delete",
    "patients.modal.deleteHint": "Click once more to confirm deletion.",
    "patients.modal.cancel": "Cancel",
    "patients.modal.lastUpdate": "Added just now",
    "patients.add": "Add patient",
    "patients.list.title": "Patients",
    "patients.list.subtitle": "Minimal view and quick actions",
    "patients.list.name": "Full name",
    "patients.list.actions": "Actions",
    "patients.list.view": "View",
    "patients.list.edit": "Edit",
    "patients.list.delete": "Delete",
    "patients.list.viewAria": "View details for {name}",
    "patients.list.editAria": "Edit details for {name}",
    "patients.list.deleteAria": "Delete patient {name}",
    "patients.list.loading": "Loading patients...",
    "patients.list.empty": "No patients yet.",
    "patients.error": "Could not load patients.",
    "patients.saveError": "Could not save patient.",
    "patients.deleteError": "Could not delete patient.",
    "workers.title": "Workers",
    "workers.subtitle": "Quick overview & management",
    "workers.description":
      "See your staff list, edit basic info or open the detailed profile.",
    "workers.add": "Add worker",
    "workers.list.title": "Workers",
    "workers.list.subtitle": "Minimal view and quick actions",
    "workers.list.name": "Full name",
    "workers.list.actions": "Actions",
    "workers.list.view": "View",
    "workers.list.edit": "Edit",
    "workers.list.delete": "Delete",
    "workers.list.viewAria": "View details for {name}",
    "workers.list.editAria": "Edit details for {name}",
    "workers.list.deleteAria": "Delete worker {name}",
    "workers.list.loading": "Loading workers...",
    "workers.list.empty": "No workers yet.",
    "workers.error": "Could not load workers.",
    "workers.saveError": "Could not save worker.",
    "workers.deleteError": "Could not delete worker.",
    "workers.modal.title": "Add worker",
    "workers.modal.viewTitle": "Worker profile",
    "workers.modal.editTitle": "Edit worker",
    "workers.modal.subtitle": "Capture the profile details before assigning shifts.",
    "workers.modal.viewSubtitle": "Quick profile view; edit if something changed.",
    "workers.modal.editSubtitle": "Update status or planned hours and save.",
    "workers.modal.nameLabel": "Full name",
    "workers.modal.namePlaceholder": "First + last name",
    "workers.modal.cityLabel": "City",
    "workers.modal.cityPlaceholder": "Berlin, Munich...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.hoursPlannedLabel": "Planned hours",
    "workers.modal.hoursPlannedHelper": "Monthly planned hours.",
    "workers.modal.save": "Save worker",
    "workers.modal.update": "Save changes",
    "workers.modal.saving": "Saving...",
    "workers.modal.deleting": "Deleting...",
    "workers.modal.confirmDelete": "Confirm delete",
    "workers.modal.deleteHint": "Click once more to delete the worker.",
    "workers.modal.cancel": "Cancel",
    "common.backTo": "Back to {target}",
    "patientDetail.label": "Patient",
    "patientDetail.activeShifts": "Current shifts",
    "patientDetail.shiftsSubtitle": "Dummy data — will fetch from Supabase later",
    "patientDetail.noShifts": "No shifts defined yet.",
    "patientDetail.shift.day": "Day",
    "patientDetail.shift.night": "Night",
    "patientDetail.planTitle": "AI plan - preview",
    "patientDetail.planSubtitle": "See the proposal before saving",
    "patientDetail.planMissing": "Plan not generated",
    "patientDetail.planHint": "Add a prompt in the planner to see the schedule.",
    "patientDetail.openPlanner": "Open AI planner",
    "workerDetail.label": "Worker",
    "workerDetail.planned": "Planned {hours}h",
    "workerDetail.completed": "Completed {hours}h",
    "workerDetail.shift.day": "Day shifts",
    "workerDetail.shift.night": "Night shifts",
    "workerDetail.activeShifts": "Current shifts",
    "workerDetail.shiftsSubtitle": "Dummy overview — wire to Supabase later",
    "workerDetail.noShifts": "No shifts scheduled.",
    "planner.title": "AI planner",
    "planner.workersLabel": "Workers",
    "planner.patient.label": "Patient",
    "planner.patient.placeholder": "Select a patient",
    "planner.patient.loading": "Loading patients...",
    "planner.patient.empty": "No patients found.",
    "planner.worker.searchTitle": "Workers",
    "planner.worker.searchSelected": "{count} selected · click to add more",
    "planner.worker.searchPlaceholder": "Search or scroll the list",
    "planner.worker.searchInputPlaceholder": "Name, city or role",
    "planner.worker.searchEmpty": "No results",
    "planner.worker.searchBadge": "Live search",
    "planner.worker.status.radnik": "Staff",
    "planner.worker.status.anarbeitung": "Anarbeitung",
    "planner.worker.status.student": "Student",
    "planner.worker.status.externi": "External",
    "planner.worker.status.pocetnik": "Trainee",
    "planner.worker.status.anerkennung": "Recognition",
    "planner.worker.roleFallback": "No role provided",
    "planner.worker.removeAria": "Remove worker",
    "planner.worker.priority": "Priority",
    "planner.worker.addPriority": "Mark as priority",
    "planner.worker.shiftFocus": "Shift focus",
    "planner.worker.planDays": "Plan up to",
    "planner.worker.balance": "Balance D / N",
    "planner.worker.focusBalanced": "Balanced",
    "planner.worker.focusDay": "Day {percent}%",
    "planner.worker.focusNight": "Night {percent}%",
    "planner.worker.allowDay": "Day",
    "planner.worker.allowNight": "Night",
    "planner.lockShift": "Lock shift",
    "planner.unlockShift": "Unlock shift",
    "planner.lockedLabel": "Locked",
    "planner.unsavedChanges": "Unsaved changes — click Save plan",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Short prompt: rotate nights every 2-3 days, Maja day shifts, avoid overlaps...",
    "planner.generate": "Generate proposal",
    "planner.export": "Export plan",
    "planner.generate.monthLabel": "Month",
    "planner.generate.yearLabel": "Year",
    "planner.save": "Save plan",
    "planner.preview.kicker": "Plan overview",
    "planner.preview.title": "Worker rotation preview",
    "planner.preview.meta": "{days} days",
    "planner.preview.date": "Date",
    "planner.preview.day": "Day",
    "planner.preview.night": "Night",
    "planner.shift.dayLabel": "Day shift",
    "planner.shift.nightLabel": "Night shift",
    "planner.shift.unknown": "Unknown",
    "planner.noAvailableWorkers": "No available workers",
    "planner.loadError": "Failed to load planner data.",
    "planner.loading": "Loading data...",
    "planner.noWorkers": "No workers in the database — add them on the Workers page.",
    "planner.generateMissing": "Select a patient and at least one worker.",
    "planner.generateSuccess": "AI proposal is ready.",
    "planner.generateError": "Could not generate the plan.",
    "planner.saveSuccess": "Plan saved to Supabase.",
    "planner.saveError": "Could not save the plan.",
    "planner.generating": "Generating...",
    "planner.saving": "Saving...",
    "planner.preview.assigned": "{count} shifts assigned",
    "planner.daysClamped": "Requested days capped to {max}.",
    "overview.title": "Plan overview",
    "overview.subtitle": "Quick rotation overview per patient",
    "overview.unassigned": "Unassigned",
    "overview.calendar.monthLabel": "Month",
    "overview.calendar.yearLabel": "Year",
    "overview.calendar.monthSelectAria": "Select month",
    "overview.calendar.yearSelectAria": "Select year",
    "overview.calendar.todayLabel": "Today",
    "overview.summary.title": "Plan summary",
    "overview.summary.subtitle": "Key guidance and notes",
    "overview.summary.highlights": "Highlights",
    "overview.summary.empty": "No saved summary for this patient yet.",
    "overview.loadError": "Could not load the plan.",
    "overview.loading": "Loading plan...",
    "overview.noPlan": "No saved plan for this month.",
    "overview.delete": "Delete plan",
    "overview.deleteConfirm": "Confirm delete",
    "overview.deleteHint": "Click once more to delete this month's plan.",
    "overview.deleteDialog.title": "Delete plan?",
    "overview.deleteDialog.body":
      "Are you sure you want to delete this plan? Once deleted, all associated data will be permanently lost.",
    "overview.deleting": "Deleting...",
    "overview.deleteSuccess": "Plan deleted.",
    "overview.deleteError": "Could not delete the plan.",
    "analytics.title": "Analytics",
    "analytics.subtitle": "Planned shifts per worker",
    "analytics.filters.helper": "Pick worker + month + year",
    "analytics.filters.worker": "Worker",
    "analytics.filters.month": "Month",
    "analytics.filters.year": "Year",
    "analytics.loading": "Loading analytics...",
    "analytics.error": "Could not load analytics.",
    "analytics.empty": "No planned shifts for this period.",
    "analytics.cards.totalShifts": "Total shifts",
    "analytics.cards.dayShifts": "Day shifts",
    "analytics.cards.nightShifts": "Night shifts",
    "analytics.cards.totalHours": "Total hours",
    "analytics.cards.dayHours": "Day hours",
    "analytics.cards.nightHours": "Night hours",
    "analytics.cards.avgHours": "Avg per shift",
    "analytics.cards.periodLabel": "{month} {year}",
    "analytics.cards.activeWeeks": "Active weeks",
    "analytics.chart.title": "Weekly load",
    "analytics.chart.subtitle": "Day vs night per week",
    "analytics.chart.weekLabel": "Week {week}",
    "analytics.patients.title": "Patients",
    "analytics.patients.subtitle": "Assigned to",
    "analytics.patients.none": "No linked patients for this period.",
    "analytics.timeline.title": "Planned shifts",
    "analytics.timeline.subtitle": "Date, shift type and patient",
    "analytics.timeline.day": "Day shift",
    "analytics.timeline.night": "Night shift",
    "analytics.timeline.unassignedPatient": "No patient linked",
  },
  de: {
    "language.bs": "Bosnisch",
    "language.en": "Englisch",
    "language.de": "Deutsch",
    "language.bs.helper": "Originalsprache mit lokalen Begriffen.",
    "language.en.helper": "Englische Oberfläche für internationale Teams.",
    "language.de.helper": "Deutsche Oberfläche für DACH Teams.",
    "nav.aiPlanner": "KI-Planer",
    "nav.planOverview": "Plan-Übersicht",
    "nav.analytics": "Analytics",
    "nav.patients": "Patienten",
    "nav.workers": "Mitarbeiter",
    "nav.settings": "Einstellungen",
    "settings.title": "Einstellungen",
    "settings.subtitle": "Sprache und Basiseinstellungen anpassen.",
    "settings.languageLabel": "App-Sprache",
    "settings.languageDescription": "Wähle die Sprache der Oberfläche. Einstellung wird lokal gespeichert.",
    "settings.selected": "Aktiv",
    "patients.title": "Patienten",
    "patients.subtitle": "Schneller Überblick & Verwaltung",
    "patients.description":
      "Sieh die Patientenliste, bearbeite Stammdaten oder öffne die Detailansicht.",
    "patients.modal.title": "Patient hinzufügen",
    "patients.modal.viewTitle": "Patientenprofil",
    "patients.modal.editTitle": "Patient bearbeiten",
    "patients.modal.subtitle": "Schnell Basisdaten erfassen, bevor du planst.",
    "patients.modal.viewSubtitle": "Kurzer Überblick der gespeicherten Daten mit Inline-Edit.",
    "patients.modal.editSubtitle": "Stammdaten anpassen und speichern.",
    "patients.modal.nameLabel": "Name",
    "patients.modal.cityLabel": "Stadt",
    "patients.modal.levelLabel": "Pflegegrad",
    "patients.modal.notesLabel": "Notizen",
    "patients.modal.namePlaceholder": "Vor- und Nachname",
    "patients.modal.cityPlaceholder": "Berlin, Hamburg...",
    "patients.modal.levelPlaceholder": "Pflegegrad (z. B. 3)",
    "patients.modal.notesPlaceholder": "Besondere Hinweise, Allergien...",
    "patients.modal.save": "Patient speichern",
    "patients.modal.update": "Änderungen speichern",
    "patients.modal.saving": "Speichere...",
    "patients.modal.deleting": "Lösche...",
    "patients.modal.confirmDelete": "Löschen bestätigen",
    "patients.modal.deleteHint": "Klicke erneut, um das Löschen zu bestätigen.",
    "patients.modal.cancel": "Abbrechen",
    "patients.modal.lastUpdate": "Gerade erst angelegt",
    "patients.add": "Patient hinzufügen",
    "patients.list.title": "Patienten",
    "patients.list.subtitle": "Kompaktansicht mit Schnellaktionen",
    "patients.list.name": "Name",
    "patients.list.actions": "Aktionen",
    "patients.list.view": "Ansehen",
    "patients.list.edit": "Bearbeiten",
    "patients.list.delete": "Löschen",
    "patients.list.viewAria": "Details zu {name} ansehen",
    "patients.list.editAria": "Daten für {name} bearbeiten",
    "patients.list.deleteAria": "Patient {name} löschen",
    "patients.list.loading": "Patienten werden geladen...",
    "patients.list.empty": "Noch keine Patienten.",
    "patients.error": "Patienten konnten nicht geladen werden.",
    "patients.saveError": "Patient konnte nicht gespeichert werden.",
    "patients.deleteError": "Patient konnte nicht gelöscht werden.",
    "workers.title": "Mitarbeiter",
    "workers.subtitle": "Schneller Überblick & Verwaltung",
    "workers.description":
      "Mitarbeiterliste einsehen, Stammdaten bearbeiten oder Profil öffnen.",
    "workers.add": "Mitarbeiter hinzufügen",
    "workers.list.title": "Mitarbeiter",
    "workers.list.subtitle": "Kompaktansicht mit Schnellaktionen",
    "workers.list.name": "Name",
    "workers.list.actions": "Aktionen",
    "workers.list.view": "Ansehen",
    "workers.list.edit": "Bearbeiten",
    "workers.list.delete": "Löschen",
    "workers.list.viewAria": "Details zu {name} ansehen",
    "workers.list.editAria": "Daten für {name} bearbeiten",
    "workers.list.deleteAria": "Mitarbeiter {name} löschen",
    "workers.list.loading": "Mitarbeiter werden geladen...",
    "workers.list.empty": "Noch keine Mitarbeiter.",
    "workers.error": "Mitarbeiter konnten nicht geladen werden.",
    "workers.saveError": "Mitarbeiter konnte nicht gespeichert werden.",
    "workers.deleteError": "Mitarbeiter konnte nicht gelöscht werden.",
    "workers.modal.title": "Mitarbeiter hinzufügen",
    "workers.modal.viewTitle": "Mitarbeiterprofil",
    "workers.modal.editTitle": "Mitarbeiter bearbeiten",
    "workers.modal.subtitle": "Gib die wichtigsten Daten ein, bevor du ihn planst.",
    "workers.modal.viewSubtitle": "Schnelle Profilansicht – bei Bedarf bearbeiten.",
    "workers.modal.editSubtitle": "Status oder Stunden anpassen und speichern.",
    "workers.modal.nameLabel": "Name",
    "workers.modal.namePlaceholder": "Vor- und Nachname",
    "workers.modal.cityLabel": "Stadt",
    "workers.modal.cityPlaceholder": "Berlin, München...",
    "workers.modal.statusLabel": "Status",
    "workers.modal.hoursPlannedLabel": "Geplante Stunden",
    "workers.modal.hoursPlannedHelper": "Geplante Monatsstunden.",
    "workers.modal.save": "Mitarbeiter speichern",
    "workers.modal.update": "Änderungen speichern",
    "workers.modal.saving": "Speichere...",
    "workers.modal.deleting": "Lösche...",
    "workers.modal.confirmDelete": "Löschen bestätigen",
    "workers.modal.deleteHint": "Klicke erneut, um den Mitarbeiter zu löschen.",
    "workers.modal.cancel": "Abbrechen",
    "common.backTo": "Zurück zu {target}",
    "patientDetail.label": "Patient",
    "patientDetail.activeShifts": "Aktuelle Dienste",
    "patientDetail.shiftsSubtitle": "Dummy-Daten — später Supabase-Anbindung",
    "patientDetail.noShifts": "Noch keine Dienste hinterlegt.",
    "patientDetail.shift.day": "Tagdienst",
    "patientDetail.shift.night": "Nachtdienst",
    "patientDetail.planTitle": "KI-Plan - Vorschau",
    "patientDetail.planSubtitle": "Vorschlag ansehen bevor er gespeichert wird",
    "patientDetail.planMissing": "Plan nicht generiert",
    "patientDetail.planHint": "Füge im Planer einen Prompt hinzu, um den Plan zu sehen.",
    "patientDetail.openPlanner": "KI-Planer öffnen",
    "workerDetail.label": "Mitarbeiter",
    "workerDetail.planned": "Geplant {hours}h",
    "workerDetail.completed": "Geleistet {hours}h",
    "workerDetail.shift.day": "Tagdienste",
    "workerDetail.shift.night": "Nachtdienste",
    "workerDetail.activeShifts": "Aktuelle Dienste",
    "workerDetail.shiftsSubtitle": "Dummy-Übersicht — später Supabase-Anbindung",
    "workerDetail.noShifts": "Keine Dienste geplant.",
    "planner.title": "KI-Planer",
    "planner.workersLabel": "Mitarbeiter",
    "planner.patient.label": "Patient",
    "planner.patient.placeholder": "Patient auswählen",
    "planner.patient.loading": "Patienten werden geladen...",
    "planner.patient.empty": "Keine Patienten gefunden.",
    "planner.worker.searchTitle": "Mitarbeiter",
    "planner.worker.searchSelected": "{count} ausgewählt · klicke um mehr hinzuzufügen",
    "planner.worker.searchPlaceholder": "Liste durchsuchen oder scrollen",
    "planner.worker.searchInputPlaceholder": "Name, Stadt oder Rolle",
    "planner.worker.searchEmpty": "Keine Ergebnisse",
    "planner.worker.searchBadge": "Live-Suche",
    "planner.worker.status.radnik": "Fachkraft",
    "planner.worker.status.anarbeitung": "Anarbeitung",
    "planner.worker.status.student": "Student",
    "planner.worker.status.externi": "Extern",
    "planner.worker.status.pocetnik": "Einsteiger",
    "planner.worker.status.anerkennung": "Anerkennung",
    "planner.worker.roleFallback": "Keine Rolle angegeben",
    "planner.worker.removeAria": "Mitarbeiter entfernen",
    "planner.worker.priority": "Priorität",
    "planner.worker.addPriority": "Als Priorität markieren",
    "planner.worker.shiftFocus": "Schicht-Fokus",
    "planner.worker.planDays": "Bis zu Schichten",
    "planner.worker.balance": "Balance T / N",
    "planner.worker.focusBalanced": "Ausgewogen",
    "planner.worker.focusDay": "Tag {percent}%",
    "planner.worker.focusNight": "Nacht {percent}%",
    "planner.worker.allowDay": "Tag",
    "planner.worker.allowNight": "Nacht",
    "planner.lockShift": "Schicht sperren",
    "planner.unlockShift": "Schicht entsperren",
    "planner.lockedLabel": "Gesperrt",
    "planner.unsavedChanges": "Änderungen nicht gespeichert — klicke \"Plan speichern\"",
    "planner.promptLabel": "Prompt",
    "planner.promptPlaceholder":
      "Kurzbeschreibung: Nachtdienste alle 2-3 Tage rotieren, Maja Tagdienste, keine Überschneidungen...",
    "planner.generate": "Vorschlag generieren",
    "planner.export": "Plan exportieren",
    "planner.generate.monthLabel": "Monat",
    "planner.generate.yearLabel": "Jahr",
    "planner.save": "Plan speichern",
    "planner.preview.kicker": "Plan-Übersicht",
    "planner.preview.title": "Vorschau der Mitarbeitereinteilung",
    "planner.preview.meta": "{days} Tage",
    "planner.preview.date": "Datum",
    "planner.preview.day": "Tag",
    "planner.preview.night": "Nacht",
    "planner.shift.dayLabel": "Tagdienst",
    "planner.shift.nightLabel": "Nachtdienst",
    "planner.shift.unknown": "Unbekannt",
    "planner.noAvailableWorkers": "Keine verfügbaren Mitarbeiter",
    "planner.loadError": "Fehler beim Laden der Daten.",
    "planner.loading": "Daten werden geladen...",
    "planner.noWorkers": "Keine Mitarbeiter in der Datenbank – füge sie unter \"Mitarbeiter\" hinzu.",
    "planner.generateMissing": "Wähle einen Patienten und mindestens einen Mitarbeiter.",
    "planner.generateSuccess": "KI-Vorschlag ist bereit.",
    "planner.generateError": "Plan konnte nicht generiert werden.",
    "planner.saveSuccess": "Plan wurde in Supabase gespeichert.",
    "planner.saveError": "Plan konnte nicht gespeichert werden.",
    "planner.generating": "Generiere...",
    "planner.saving": "Speichere...",
    "planner.preview.assigned": "{count} Dienste zugewiesen",
    "planner.daysClamped": "Wunsch-Tage auf {max} begrenzt.",
    "overview.title": "Plan-Übersicht",
    "overview.subtitle": "Schneller Rotationsüberblick pro Patient",
    "overview.unassigned": "Nicht zugewiesen",
    "overview.calendar.monthLabel": "Monat",
    "overview.calendar.yearLabel": "Jahr",
    "overview.calendar.monthSelectAria": "Monat wählen",
    "overview.calendar.yearSelectAria": "Jahr wählen",
    "overview.calendar.todayLabel": "Heute",
    "overview.summary.title": "Plan-Zusammenfassung",
    "overview.summary.subtitle": "Wichtige Hinweise und Notizen",
    "overview.summary.highlights": "Highlights",
    "overview.summary.empty": "Noch keine gespeicherte Zusammenfassung für diesen Patienten.",
    "overview.loadError": "Plan konnte nicht geladen werden.",
    "overview.loading": "Plan wird geladen...",
    "overview.noPlan": "Kein gespeicherter Plan für diesen Monat.",
    "overview.delete": "Plan löschen",
    "overview.deleteConfirm": "Löschen bestätigen",
    "overview.deleteHint": "Klicke erneut, um den Plan für diesen Monat zu löschen.",
    "overview.deleteDialog.title": "Plan löschen?",
    "overview.deleteDialog.body":
      "Bist du sicher, dass du diesen Plan löschen möchtest? Nach dem Löschen gehen alle zugehörigen Daten dauerhaft verloren.",
    "overview.deleting": "Lösche...",
    "overview.deleteSuccess": "Plan wurde gelöscht.",
    "overview.deleteError": "Plan konnte nicht gelöscht werden.",
    "analytics.title": "Analytics",
    "analytics.subtitle": "Geplante Dienste pro Mitarbeiter",
    "analytics.filters.helper": "Wähle Mitarbeiter + Monat + Jahr",
    "analytics.filters.worker": "Mitarbeiter",
    "analytics.filters.month": "Monat",
    "analytics.filters.year": "Jahr",
    "analytics.loading": "Analytik wird geladen...",
    "analytics.error": "Analytik konnte nicht geladen werden.",
    "analytics.empty": "Keine geplanten Dienste für diesen Zeitraum.",
    "analytics.cards.totalShifts": "Dienste gesamt",
    "analytics.cards.dayShifts": "Tagdienste",
    "analytics.cards.nightShifts": "Nachtdienste",
    "analytics.cards.totalHours": "Stunden gesamt",
    "analytics.cards.dayHours": "Stunden Tag",
    "analytics.cards.nightHours": "Stunden Nacht",
    "analytics.cards.avgHours": "Ø pro Dienst",
    "analytics.cards.periodLabel": "{month} {year}",
    "analytics.cards.activeWeeks": "Aktive Wochen",
    "analytics.chart.title": "Wöchentliche Last",
    "analytics.chart.subtitle": "Tag vs Nacht pro Woche",
    "analytics.chart.weekLabel": "Woche {week}",
    "analytics.patients.title": "Patienten",
    "analytics.patients.subtitle": "Zugeordnet zu",
    "analytics.patients.none": "Keine verbundenen Patienten in diesem Zeitraum.",
    "analytics.timeline.title": "Geplante Dienste",
    "analytics.timeline.subtitle": "Datum, Dienst und Patient",
    "analytics.timeline.day": "Tagdienst",
    "analytics.timeline.night": "Nachtdienst",
    "analytics.timeline.unassignedPatient": "Ohne Patienten",
  },
} satisfies Record<Language, Record<string, string>>;

type TranslationKey = keyof typeof translations.bs;

type TranslationContextValue = {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: TranslationKey, vars?: Record<string, string | number>) => string;
};

const LanguageContext = createContext<TranslationContextValue | undefined>(
  undefined
);

function isLanguage(value: string | null): value is Language {
  return value === "bs" || value === "en" || value === "de";
}

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [language, setLanguage] = useState<Language>(() => {
    if (typeof window === "undefined") return "bs";
    const stored = window.localStorage.getItem("pflege-language");
    return isLanguage(stored) ? stored : "bs";
  });

  useEffect(() => {
    if (typeof window === "undefined") return;
    window.localStorage.setItem("pflege-language", language);
    document.documentElement.lang = language;
  }, [language]);

  const translate = useMemo(() => {
    return (key: TranslationKey, vars?: Record<string, string | number>) => {
      const template =
        translations[language]?.[key] ?? translations.bs[key] ?? key;

      if (!vars) return template;
      return Object.keys(vars).reduce(
        (acc, varKey) =>
          acc.replace(new RegExp(`{${varKey}}`, "g"), String(vars[varKey])),
        template
      );
    };
  }, [language]);

  const value = useMemo(
    () => ({
      language,
      setLanguage,
      t: translate,
    }),
    [language, translate]
  );

  return (
    <LanguageContext.Provider value={value}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useTranslations() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useTranslations must be used within LanguageProvider");
  }
  return context;
}

export const LANGUAGE_OPTIONS: {
  code: Language;
  accent: string;
  short: string;
}[] = [
  { code: "bs", accent: "from-sky-500 via-sky-400 to-amber-400", short: "BS" },
  { code: "de", accent: "from-amber-500 via-orange-400 to-red-500", short: "DE" },
  { code: "en", accent: "from-indigo-500 via-blue-500 to-sky-500", short: "EN" },
];
